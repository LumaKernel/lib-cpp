---
title: きたまさ法
---

$ K + 1 $ 項間の漸化式と $a_0, \cdots , a_{K-1}$ が与えられたとき， $a_N$ を $O(K^2 \log N)$ で求めます．

高速きたまさ法はこれをさらに高速化し，$O(K \log K \log N)$ で求めます．

コンパニオン行列を用いれば $O(K^3 \log N)$ で求めることができますが，コンパニオン行列を用いた方法は蟻本にあるのでそこまでの導入は省きます．

また，完全な導入は少なめで，証明などを主に書いていこうと思います．備忘録程度に活用してください．

数列と多項式は密接な関係があるのですが，ここでは数列で表示していきます．

また，数列を $c = (c_i)_{i=0}^{K-1}$ みたいに書いてみました．

# 前提

$c = (c_i)_{i=0}^{K-1}$ <!---->, $a_0, \cdots , a_{K-1}$ が与えられる．

任意の整数 $n$ について，

$$
\begin{aligned}
&a_{n+K} &&= c_0a_n + c_1a_{n+1} + \cdots + c_{K-1}a_{n+K-1} \\
&&&= \sum_{i=0}^{K-1} c_ia_{n+i}
\end{aligned}
$$

が成り立つこと．

# 補題1

任意の $n, m, l$ と$s = (s_i)_{i=0}^{K-1}$ について

$$  
a_n = \sum_{i=0}^{K-1}s_ia_{l+i}  
$$

が成り立つ**ならば**

$$  
a_{n+m} = \sum_{i=0}^{K-1}s_ia_{l+m+i}  
$$

が成り立つ．

# 補題1の説明

前者を $a_0$ が基準である数列であると捉えると，  
後者は $a_m$ が基準である数列と考えることができます．

K項間フィボナッチ数列は任意の整数 $m$ ずらしても同じ関係を保ちます．

この事自体を証明するのはちょっとわかりませんでした（むずかしそう

直感的に自明だけど，きたまさ法において超重要なことです．

# 任意の要素を初項の線型結合で表す

初項はここでは $a_0, \cdots, a_{K-1}$ のことです．

$a_m$ を考えます．

$a_m = \sum_{i=0}^{K-1} b_{m,k-1-i} a_i$ と表すことができます．

このことは簡単で，

$ 0 \geq m \le K$ の場合は $b_{m, m} = 1$ 他は $0$ とすれば成り立ちます．

それ以外であれば，前提を $n=m$, $n=m-1$, ... と減らしながら適用していくことで，初項の線型結合で表すことができます．

さて，きたまさ法の本質は $b_m = (b_{m, i})_{i=0}^{K-1}$ を求めることです．

$b_u$ と $b_v$ が求まっているとします．



